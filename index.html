<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <title>Invoice - Nitin Studio &amp; Jan Sewa Kendra</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #f7f7f7;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }
    .a4-page {
      display: inline-block;
      width: auto;
      min-width: 340px;
      max-width: 210mm;
      max-height: 297mm;
      padding: 20px;
      margin: 30px 0;
      background: white;
      box-shadow: 0 0 5px #ccc;
      position: relative;
      border: double 4px #224488;
      outline: double 8px #525252;
      box-sizing: border-box;
      overflow: hidden;
      z-index: 10;
    }
    /* ====== HEADER SECTION BG ====== */
    .invoice-header-section {
      background: linear-gradient(94deg, #edf8ee 10%, #d5e9f8 80%);
      border-radius: 12px;
      box-shadow: 0 2px 15px rgba(25, 120, 130, 0.08);
      padding: 14px 16px 10px 16px;
      margin-bottom: 12px;
    }
    .header {
      width: 100%;
      text-align: center;
      font-weight: bold;
      font-size: 22px;
      margin-bottom: 8px;
    }
    .invoice-title {
      background: linear-gradient(90deg, #16a34a, #0f713d);
      color: #fff;
      display: inline-block;
      padding: 5px 10px;
      border-radius: 9px;
      box-shadow: 0 4px 10px rgba(22, 163, 74, 0.5);
      font-size: 28px;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
      text-align: center;
      user-select: none;
      transition: background 0.3s ease;
    }
    .invoice-title:hover {
      background: linear-gradient(90deg, #0f713d, #16a34a);
      cursor: default;
    }

    .studio-name {
      width: 100%;
      text-align: center;
      font-size: 26px;
      font-weight: bold;
      margin-bottom: 4px;
      letter-spacing: 1px;
    }
    .address-row {
      width: 100%;
      text-align: center;
      font-size: 18px;
      margin-bottom: 3px;
    }
    .contact-row {
      display: flex;
      justify-content: space-between;
      font-size: 16px;
      margin-bottom: 5px;
    }
    .contact-left {
      text-align: left;
      width: 49%;
      font-size: 15px;
    }
    .contact-right {
      text-align: right;
      width: 49%;
      font-size: 15px;
    }
    .flex-row {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      background: linear-gradient(94deg, #e1f8ed 10%, #f7fcef 80%);
      border-radius: 10px;
      padding: 8px;
      margin-bottom: 5px;
    }
    .flex-col {
      flex: 1;
    }
    .flex-row > .flex-col:last-child {
      text-align: right;
      padding-left: 70px;
      max-width: 34%;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 7px;
    }
    th,
    td {
      border: 1px solid #222;
      padding: 7px 4px;
      text-align: center;
      font-size: 15px;
    }
    table thead tr th {
      background-color: #007bff;
      color: white;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }

    input,
    select {
      font-size: 15px;
      padding: 2px;
      box-sizing: border-box;
    }
    input {
      width: 98%;
      border: none;
      border-bottom: 1.5px solid transparent;
      transition: border-color 0.3s ease;
    }
    input.empty {
      border-bottom: 1.5px solid #ccc;
    }
    select {
      width: 90px;
    }

    /* ग्रैंड टोटल को राइट एलाइन और पूरी लाइन पर करने के लिए */
    .totals-container {
      display: flex;
      justify-content: flex-end;
      margin-top: 8px;
      padding-right: 10px;
      background: linear-gradient(94deg, #e1f8ed 10%, #f7fcef 80%);
      border-radius: 10px;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    .totals {
      text-align: right;
      font-size: 17px;
      font-weight: bold;
      border: 2px solid #224488;
      padding: 8px 12px;
      border-radius: 4px;
      min-width: 180px;
      background-color: #fff;
      box-sizing: border-box;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }

    .footer {
      margin-top: 12px;
      font-size: 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .footer-left {
      flex: 1;
    }
    .footer-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .print-btn {
      background: #007bff;
      color: #fff;
      border: none;
      padding: 10px 28px;
      cursor: pointer;
      font-size: 17px;
      border-radius: 5px;
      margin: 15px 0;
      display: block;
      width: fit-content;
      float: none;
      position: relative;
      z-index: 20;
    }
    #add-product-btn {
      margin-top: 8px;
      margin-bottom: 3px;
      padding: 6px 14px;
      font-size: 15px;
      cursor: pointer;
    }
    .delete-btn {
      background: #d9534f;
      color: white;
      border: none;
      padding: 4px 8px;
      cursor: pointer;
      font-size: 14px;
      border-radius: 3px;
    }
    .watermark {
      position: absolute;
      top: 50%;
      left: 50%;
      transform-origin: center center;
      opacity: 0.1;
      pointer-events: none;
      user-select: none;
      z-index: 0;
      max-width: 70%;
      max-height: 70%;
      height: auto;
      width: auto;
      transform: translate(-50%, -50%) scale(1);
      display: block;
    }
    #signature-display {
      max-height: 80px;
      max-width: 200px;
    }
    #signature-display img {
      max-height: 80px;
      max-width: 100%;
    }
    #signature-display hr {
      border: 0.5px solid #000;
      margin: 0;
      width: 150px;
    }
    @media print {
      body,
      .a4-page {
        box-shadow: none;
        margin: 0;
      }
      .print-btn,
      #add-product-btn,
      .delete-btn,
      select {
        display: none !important;
      }
      .payment-mode-text {
        display: inline !important;
        font-weight: bold;
        font-size: 15px;
      }
      .payment-mode-select {
        display: none !important;
      }
      input,
      select {
        border: none !important;
        -webkit-appearance: none !important;
        -moz-appearance: none !important;
        appearance: none !important;
        box-shadow: none !important;
      }
      .invoice-title {
        background: linear-gradient(90deg, #16a34a, #0f713d) !important;
        color: #fff !important;
        display: inline-block !important;
        padding: 5px 10px !important;
        border-radius: 5px !important;
        box-shadow: 0 4px 8px rgba(22, 163, 74, 0.5) !important;
        font-size: 28px !important;
        font-weight: 700 !important;
        letter-spacing: 2px !important;
        text-transform: uppercase !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        text-align: center !important;
        user-select: none !important;
      }
      table#invoice-table tr th:last-child,
      table#invoice-table tr td:last-child {
        display: none !important;
      }
      table thead tr th {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        background-color: #007bff !important;
        color: white !important;
      }
      .a4-page {
        border: double 4px #224488 !important;
        outline: double 4px #525252 !important;
        box-sizing: border-box !important;
        width: auto !important;
        min-width: 240px !important;
        max-width: 210mm !important;
        max-height: 297mm !important;
        padding: 10px !important;
        margin: 0 auto !important;
        display: inline-block !important;
        overflow: hidden !important;
      }
      .totals-container {
        justify-content: flex-end !important;
        padding-right: 10px !important;
        background: linear-gradient(94deg, #e1f8ed 10%, #f7fcef 80%) !important;
        border-radius: 10px !important;
      }
      .totals {
        border: 2px solid #224488 !important;
        padding: 8px 12px !important;
        font-weight: bold !important;
        font-size: 17px !important;
        min-width: 180px !important;
        background-color: #fff !important;
        box-sizing: border-box !important;
      }
      /* Added for flex-row background in print */
      .flex-row {
        background: linear-gradient(94deg, #e1f8ed 10%, #f7fcef 80%) !important;
        border-radius: 10px !important;
        padding: 8px !important;
        margin-bottom: 5px !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
      }
    }
  </style>
</head>
<body>
  <div class="a4-page" id="invoice">
    <img
      src="https://lh3.googleusercontent.com/d/1bIanKUOQ-oUhdfk6cocXuHzrFwg9t0Y1=w300"
      alt="Watermark"
      class="watermark"
      id="watermark"
    />
    <button class="print-btn" onclick="printInvoice()">बिल प्रिंट करें</button>
    <!-- ====== HEADER SECTION START ====== -->
    <div class="invoice-header-section">
      <div class="header">
        <div class="invoice-title">INVOICE</div>
      </div>
      <div class="studio-name">NITIN STUDIO &amp; JAN SEWA KENDRA</div>
      <div class="address-row">Mohammdi Road Main Churaha Mamri Kheri</div>
      <div class="contact-row">
        <div class="contact-left">✉ nitinmamri@gmail.com</div>
        <div class="contact-right">☎ 9956691683</div>
      </div>
      <div class="flex-row">
        <div class="flex-col">
          Name:
          <input type="text" id="name" style="width: 82%; margin-top: 2px" />
          Address:
          <input type="text" id="address" style="width: 78%; margin-top: 2px" />
          Mobile No:
          <input type="text" id="mobile" style="width: 75%; margin-top: 2px" />
        </div>
        <div class="flex-col">
          Date:
          <input type="date" id="inv-date" style="width: 60%" /><br />
          Invoice No:
          <input type="text" id="inv-no" style="width: 43%; margin-top: 3px" />
        </div>
      </div>
    </div>
    <!-- ====== HEADER SECTION END ====== -->

    <form autocomplete="off" onsubmit="return false;">
      <table id="invoice-table">
        <thead>
          <tr>
            <th>S/R</th>
            <th>PRODUCT DESCRIPTION</th>
            <th>QTY</th>
            <th>PRICE</th>
            <th>TOTAL</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="rows">
          <!-- यहाँ कोई डिफ़ॉल्ट row नहीं डाली गई -->
        </tbody>
      </table>
      <button type="button" id="add-product-btn" onclick="addRow()">
        + Add Product
      </button>
      <div class="totals-container">
        <div class="totals">
          Total : <span id="grand-total">0.00</span>
        </div>
      </div>
      <div class="footer">
        <div class="footer-left">
          Payment Date:
          <input type="date" id="pay-date" style="width: 23%" /><br />
          Payment Mode:
          <select
            id="payment-mode-select"
            class="payment-mode-select"
            onchange="updatePaymentModeText()"
          >
            <option value="UPI">UPI</option>
            <option value="Cash">Cash</option>
          </select>
          <span class="payment-mode-text" style="display: none">UPI</span>
        </div>
        <div class="footer-right">
          <span class="sign">Signature:</span>
          <select
            id="signature-option"
            onchange="signatureChange()"
            style="font-size: 14px"
          >
            <option value="">-- Select --</option>
            <option value="https://lh3.googleusercontent.com/d/1YtLptLLQX13fqaHAN-xrAHtQn7v__g2K=w300">
              मेरी मोहर
            </option>
            <option value="line">लाइन </option>
          </select>
          <div id="signature-display"></div>
        </div>
      </div>
    </form>

  </div>

  <script>
    function addRow() {
      const rowCount = document.querySelectorAll("#rows tr").length + 1;
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${rowCount}</td>
        <td><input type="text" name="product" placeholder="Product description" oninput="calc();"></td>
        <td><input type="number" min="1" value="1" name="qty" oninput="calc();"></td>
        <td><input type="number" min="0" value="0" name="price" oninput="calc();"></td>
        <td><span name="total">0</span></td>
        <td><button type="button" class="delete-btn" onclick="deleteRow(this)">X</button></td>
      `;
      document.getElementById("rows").appendChild(tr);
      calc();
    }
    function deleteRow(btn) {
      btn.closest("tr").remove();
      updateSR();
      calc();
    }
    function updateSR() {
      Array.from(document.querySelectorAll("#rows tr")).forEach((tr, i) => {
        tr.children[0].textContent = i + 1;
      });
    }
    function calc() {
      let sum = 0;
      document.querySelectorAll("#rows tr").forEach((tr) => {
        const qty = Number(tr.querySelector('[name="qty"]').value);
        const price = Number(tr.querySelector('[name="price"]').value);
        const total = qty * price;
        tr.querySelector('[name="total"]').textContent = total.toFixed(2);
        sum += total;
      });
      document.getElementById("grand-total").textContent = sum.toFixed(2);
    }
    function updatePaymentModeText() {
      const select = document.getElementById("payment-mode-select");
      const textSpan = document.querySelector(".payment-mode-text");
      textSpan.textContent = select.value;
    }
    function printInvoice() {
      updatePaymentModeText();
      window.print();
    }
    function signatureChange() {
      const select = document.getElementById("signature-option");
      const display = document.getElementById("signature-display");
      const val = select.value;
      if (val === "line") {
        display.innerHTML =
          '<hr style="border: 0.5px solid #000; margin: 0;">';
      } else if (val) {
        display.innerHTML = `<img src="${val}" alt="Mohr" style="max-height: 90px; max-width: 100%;">`;
      } else {
        display.innerHTML = "";
      }
    }
    function adjustWatermarkSize() {
      const watermark = document.getElementById("watermark");
      const invoice = document.getElementById("invoice");
      if (!watermark || !invoice) return;
      const invoiceRect = invoice.getBoundingClientRect();
      const scale = Math.min(
        (invoiceRect.width * 0.7) / watermark.naturalWidth,
        (invoiceRect.height * 0.7) / watermark.naturalHeight,
        1
      );
      watermark.style.transform = `translate(-50%, -50%) scale(${scale})`;
      watermark.style.display = "block";
    }
    function checkEmptyInputs() {
      ["name", "address", "mobile"].forEach((id) => {
        const input = document.getElementById(id);
        if (input) {
          if (input.value.trim() === "") {
            input.classList.add("empty");
          } else {
            input.classList.remove("empty");
          }
        }
      });
    }
    window.addEventListener("resize", adjustWatermarkSize);
    window.addEventListener("scroll", adjustWatermarkSize);
    window.onload = () => {
      addRow();
      adjustWatermarkSize();
      updatePaymentModeText();
      checkEmptyInputs();
    };
    ["name", "address", "mobile"].forEach((id) => {
      const input = document.getElementById(id);
      if (input) {
        input.addEventListener("input", checkEmptyInputs);
      }
    });
  </script>
</body>
</html>
